# Особенности работы в Wayland

Протокол Wayland, используемый по умолчанию во многих современных дистрибутивах (Ubuntu, Fedora), имеет более строгую модель безопасности, что создает некоторые трудности для приложений вроде far2l.

### Суть проблемы

Из соображений безопасности Wayland не позволяет приложениям легко перехватывать ввод с клавиатуры или получать доступ к буферу обмена, если они не находятся в фокусе. Это может нарушить работу:
*   **TTY|Xi** бекенда, который полагается на X11 для получения расширенных данных о клавиатуре.
*   **GUI-версии**, особенно в части работы с буфером обмена.

### Решения

К счастью, большинство проблем уже решены или имеют простые обходные пути.

#### Автоматическая адаптация

Современные версии far2l (начиная с 2.6.1) **автоматически определяют** запуск под Wayland и адаптируются:
*   Бекенд **TTY|Xi** автоматически переключается в режим **TTY|X**, который более совместим.
*   Проблемы с буфером обмена в **GUI-версии** в основном исправлены.

#### Решение для GUI-версии (XWayland)

Если у вас все еще возникают проблемы с GUI-версией (например, с буфером обмена или перетаскиванием), запустите ее в режиме совместимости с X11 (XWayland).

*   **Разовый запуск из консоли:**
    ```shell
    GDK_BACKEND=x11 far2l
    ```
*   **Постоянное решение (изменить ярлык):**
    1.  Откройте файл `/usr/share/applications/far2l.desktop` с правами `sudo`.
    2.  Замените строку `Exec=far2l` на `Exec=env GDK_BACKEND=x11 far2l`.

#### Решение для терминальной версии

Используйте [современные терминалы](terminal-setup.md), такие как **kitty**, **Alacritty** или **foot**, которые имеют собственные протоколы для работы с клавиатурой и буфером обмена, не зависящие от X11.

#### "Последний довод": переключение на X11

Если ничего не помогает, вы можете переключить всю вашу систему на использование сессии X11 вместо Wayland. Это делается на экране входа в систему (обычно через иконку шестеренки перед вводом пароля).